<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Member">

	<!-- 회원저장 -->
 	<insert id="m_insert">
		INSERT INTO tbl_member
		(user_no,user_id,user_pwd,user_name,user_birth,user_gender,postcode,roadAddr,detailAddr,user_email,user_phone,join_date)
		VALUES (user_no_seq.nextval,#{user_id},#{user_pwd},#{user_name},#{user_birth},#{user_gender},
		#{postCode},#{roadAddr},#{detailAddr},#{user_email},#{user_phone},sysdate)
	</insert>
	
	<!-- 아이디 중복 검색 -->
 	<select id="m_idCheck" resultType="member">
		SELECT * FROM tbl_member WHERE user_id = #{user_id}
	</select>
 
 	<!-- 로그인 인증 처리 : 아이디와 user_state가 2가 아닌 경우만 로그인 -->
	<select id="m_loginCheck" resultType="member">
		SELECT * FROM tbl_member WHERE
		user_id = #{user_id} and user_state != 2
	</select>
 
 	<!-- id 찾기 : 이름, 핸드폰번호로 찾기 -->
	<select id="m_findId" parameterType="member" resultType="member">
		SELECT *
		FROM tbl_member WHERE user_name = #{user_name} AND user_phone = #{user_phone}
	</select>
	
	
	<!-- 아이디에 해당하는 회원정보를 보기 -->
	<select id="m_info" resultType="member">
		SELECT * FROM tbl_member
		WHERE user_id = #{user_id}
	</select>
	
	<!-- 회원 정보 수정 : 암호화된 비번, 회원 이름, 우편번호, 주소, 폰번호, 이메일 | 아이디 기준 -->
	<update id="edit_ok">
		UPDATE tbl_member SET user_name = #{user_name}, user_birth = #{user_birth},
		user_gender = #{user_gender}, postCode = #{postCode}, roadAddr = #{roadAddr},
		detailAddr = #{detailAddr}, user_phone = #{user_phone}, user_email = #{user_email}
		WHERE user_id = #{user_id}
	</update>
	
	<!-- 회원탈퇴 -->
	<update id="m_del_ok" >
		UPDATE tbl_member SET del_cont = #{del_cont}, del_date = sysdate, 
		user_state = 2 WHERE user_id = #{user_id}
	</update>
	
	<!-- 비밀번호 수정 -->
	<update id="change_pwd" >
		UPDATE tbl_member SET user_pwd = #{user_pwd} 
		WHERE user_id = #{user_id}
	</update>
</mapper>